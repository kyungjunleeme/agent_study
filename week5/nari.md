# Chapter 5. 도구 사용 및 계획 수립 기능 활성화

<주제>
- 에이전트에서 도구 사용 개념 이해
- 에이전트를 위한 계획 수립 알고리즘
- 도구 사용과 계획 수립의 통합
- 실용적인 구현 사례 탐구

## 5.1 도구 사용 개념 이해

- 에이전트 본래의 기능과 의사결정 프로세스 확장
- 에이전트가 내부 지식, 훈련 데이터, 알고리즘에만 의존해 고립적으로 작동하는 것을 넘어서게 함

1. 도구 호출
  - 외부 API, 외부 서비스, 외부 시스템과 상호 작용할 수 있게 함
2. 함수 호출
  - 동일 런타임, 사전 정의된 함수 에 대해 구조화된 호출 생성
  - 예: 데이터 베이스 조회, 내부 계산 등


- 에이전트 컨트롤러란?
  - llm이 구조호된 호출을 생성하면 에이전트 컨트롤러가 이 응답을 해석하고 실행함.
  - 제공받은 파라미터로 지정된 함수를 실제 실행할 수 있는 능력을 가진 구성 요소.
- 주지할 점
  - 모든 llm이 도구/함수 호출을 할 수 있거나, 효율적으로(또는 정확하게) 할 수 있는 것은 아님.   
  - 대형 모델들은 도구 호출 행동에 관해 명시적으로 학습되어 있음. 다른 모델들은 그렇지 않을 수 있어서 공격적인 프롬프트로 비슷한 구현 가능(병렬 호출 같은 거?). 성공률도 다름.

- 도구 정의 방법 : 프레임워크 접근 방식, 직접 llm 통합 등..
 
## 5.2 에이전트를 위한 계획 알고리즘
요즘 가장 높은 실용성을 가진 계획 알고리즘 두가지
1. LLM 기반 계획
  - 사용자 요청이 들어오면 llm이 알아서 계획 생성해서 행동을 실행하는 방식
    
2. HTN 계획 (계층적 작업 네트워크; Hierarchical Task Network)
  - 작업들을 하위 작업으로 나눠서(원칙 기반) 나머지를 llm에 의해 동작
  - 하나의 관리자 유닛이 개별 작업을 에이전트에게 위임하는 방식도 여기에 속함

## 5.3 도구 사용과 계획 통합
1. 도구 사용에 관한 추론
   - 에이전트가 자신이 사용하는 도구에 관해 추론 할 수 있어야 함. (기능, 가능성, 제약조건, 상황과 조건 등을 이해)
   - 이 때 다양한 한계를 직면할 수 있는데, 이를 해결하는 방법으로 : CrewAI, LangGragh, AutoGen 같은 프레임워크가 도구 추론 성능이 입증된 고급 모델과 사용하면 효과적
     - 도구 사용 학습이 부족한 경우 나타나는 문제 예시
       - 언제 도구 필요한지 모름
       - 도구 기능 잘못된 가정함
       - 잘못된 순서로 도구 사용
       - 도구 사용 기회 놓침
       - 도구 제약상황이나 요구사항 무시
     - 모델 학습은 충분한데, 역시 나타날 수 있는 한계 예시
       - 도구 조합 어려워함
       - 비슷한 상황에서 일관성있는 도구 선택 못함
       - 기능이 미묘한 도구 구분 못함
       - 도구가 실패했을 때 오류 복구 못함



## 5.4 실용적 구현
1. CrewAI 예제




2. AutoGen 예제




3. LangGragh 예제


   
