# Chapter 6. 조정자·작업자·위임자(CWD) 접근 방식

이 장은 **다중 에이전트 시스템(Multi-Agent System)**을 설계할 때 활용할 수 있는  
**Coordinator–Worker–Delegator(CWD)** 프레임워크를 중심으로,
역할 분리, 협업 구조, 커뮤니케이션, 그리고 생성형 AI 시스템에서의 구현 방법을 설명한다.

---

## 6.1 CWD 모델 이해

### CWD 모델 개요
CWD 모델은 다중 에이전트 시스템에서 **협업, 전문화, 작업 분산, 자원 관리**를 효과적으로 수행하기 위한 조직적 프레임워크다.

- 인간 조직의 **계층 구조와 역할 분담**에서 영감을 받음
- 단일 에이전트로 감당하기 어려운 **복잡한 작업**에 특히 적합
- 자율 에이전트들이 협력해 공동 목표를 달성하도록 설계됨

### CWD의 계층 구조
- **최상위 계층**: 조정자(Coordinator)
- **중간 계층**: 위임자(Delegator)
- **기초 계층**: 작업자(Worker)

---

### 역할 정의

#### 1) 조정자(Coordinator)
- 시스템 전체의 **작업·자원·워크플로 관리**
- 작업 우선순위 결정 및 할당
- 진행 상황 모니터링 및 병목 관리
- 오케스트레이터 역할 수행

#### 2) 위임자(Delegator)
- 조정자와 작업자 사이의 **중재자**
- 작업자 가용성·전문성 평가
- 작업 분산 및 재할당
- 작업 부하 균형 유지
- 처리량(throughput), 지연(latency), 자원 활용도 기준으로 최적화

#### 3) 작업자(Worker)
- 실제 **구체적인 작업 수행**
- 특정 도메인 전문성 보유
- 결과 및 상태를 상위 계층에 보고
- 독립적 실행 + 협업 가능

---

## 6.1.1 CWD 모델의 핵심 원칙

- **관심사의 분리 (Separation of Concerns)**  
  → 계획, 위임, 실행을 분리하여 확장성과 유지보수성 확보

- **계층적 구조 (Hierarchical Organization)**  
  → 인간 조직과 유사한 구조로 복잡성 관리

- **양방향 커뮤니케이션**
  - 하향식: 작업 지시, 우선순위, 제약 조건
  - 상향식: 진행 상황, 결과, 자원 사용 현황

- **적응성 & 회복력**
  - 작업 재분배
  - 중복 실행 허용
  - 장애 발생 시 복구 가능

- **동적 역할 재할당**
  - 시스템 요구 변화에 따라 역할 조정 가능

---

## 6.2 역할 할당을 통한 에이전트 설계

### 역할 정의의 중요성
- 각 에이전트는 **책임·권한·행동 범위**가 명확해야 함
- 역할 정의는 에이전트의 **행동 방식과 의사결정 구조**의 기반

---

### 예: 지능형 여행 에이전트 시스템

#### 주요 에이전트 역할

**조정자 에이전트**
- 전체 여행 계획 프로세스 관리
- 사용자 요구사항 분석
- 작업 분해 및 우선순위 설정

**작업자 에이전트**
- 항공권 예약
- 호텔 예약
- 액티비티 기획
- 교통편 조정

**위임자 에이전트**
- 작업자 선택 및 작업 분배
- 작업자 성능·가용성 평가
- 결과 수집 및 통합

---

### 기타 보조 역할

- **분석가(Analyst)**: 데이터 분석 기반 추천
- **반성자(Reflector)**: 시스템 성능 모니터링 및 개선 제안
- **탐색자(Searcher)**: 새로운 옵션·대안 탐색
- **작업 해석자(Task Interpreter)**: 고수준 요청을 실행 가능한 작업으로 변환

---

## 6.3 에이전트 간 커뮤니케이션 및 협업

### 6.3.1 커뮤니케이션
- 명확한 **메시지 형식과 프로토콜** 필요
- 표준화된 구조를 통해 오해 최소화
- FIPA ACL 개념 참고

### 메시지 예시
- 작업 상태 업데이트
- 진행률 보고
- 결과 전달
- 자원 요청

---

### 6.3.2 조정 메커니즘
- 작업 의존성 관리
- 우선순위 조정
- 자원 재할당
- 지연 발생 시 즉각 개입

---

### 6.3.3 협상 및 갈등 해결
- 에이전트 간 목표 충돌 발생 가능
- 사전 정의된 규칙 또는 조정자 개입으로 해결
- 사용자 선호·시스템 정책 기반 최종 결정

---

### 6.3.4 지식 공유
- 에이전트 간 조사 결과·인사이트 공유
- 시스템 전체 학습 효과 증대
- 지속적인 성능 개선 가능

---

## 6.4 생성형 AI 시스템에서 CWD 접근 방식 구현

### LLM 기반 시스템에서의 고려 사항
- 전통적 에이전트 ↔ LLM 기반 에이전트 차이 존재
- 역할·계층 구조를 **프롬프트 설계로 명시**해야 함

---

### 6.4.1 시스템 프롬프트와 에이전트 행동
시스템 프롬프트에는 다음 요소 포함:
- 역할과 책임 범위
- 의사결정 기준
- 제약 조건
- 다른 에이전트와의 상호작용 방식

---

### 6.4.2 지시 형식 지정
- 구조화된 입력/출력 사용
- JSON 등 명확한 포맷 권장
- 에이전트 간 안정적인 통신 보장

---

### 출력 예시 구조
```json
{
  "status": "completed",
  "result": {
    "options": [...],
    "recommendations": [...],
    "constraints": [...]
  }
}

## 정리
- CWD 모델은 역할 분리 + 계층 구조 + 협업 메커니즘을 통해복잡한 다중 에이전트 시스템을 효율적으로 설계할 수 있게 해준다. 
- 생성형 AI 환경에서는 이를 프롬프트·메시지 구조·워크플로 설계로 구현한다.
- 확장성, 유지보수성, 협업 효율을 동시에 달성할 수 있는 실용적 프레임워크다.
